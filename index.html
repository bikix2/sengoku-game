<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ›ãƒ¼ãƒ  - æˆ¦å›½æ”¾ç½®RPG</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .news-box { background: #222; border: 1px solid #444; padding: 10px; margin-bottom: 20px; border-radius: 4px; }
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .menu-btn { background: #333; color: #fff; padding: 20px; text-align: center; text-decoration: none; border: 1px solid #555; border-radius: 8px; font-weight: bold; display: block; transition: background 0.2s; }
        .menu-btn:hover { background: #444; }
        .menu-icon { font-size: 2rem; display: block; margin-bottom: 5px; }
        
        /* ãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ */
        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:9999; align-items:center; justify-content:center; }
        .modal-content { background:#222; border:2px solid #d4af37; padding:20px; width:90%; max-width:400px; border-radius:8px; text-align:center; color:#ccc; }
        textarea { width: 90%; height: 100px; background:#111; color:#fff; border:1px solid #555; margin-bottom:10px; padding:5px; }
    </style>
</head>
<body>

<header><h1>æˆ¦å›½æ”¾ç½®RPG</h1></header>

<div class="container">
    <div class="news-box">
        <div style="color:#d4af37; font-weight:bold; margin-bottom:5px;">â—† ãŠçŸ¥ã‚‰ã›</div>
        <div style="font-size:0.85rem; line-height:1.5;">
            ãƒ»ä¸‡å±‹ï¼ˆã‚·ãƒ§ãƒƒãƒ—ï¼‰ãŒã‚ªãƒ¼ãƒ—ãƒ³ã—ã¾ã—ãŸï¼<br>
            ãƒ»é€²è»é€Ÿåº¦ã®å¤‰æ›´æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚<br>
            ãƒ»ä¸€éƒ¨æ­¦å°†ã®ã‚¹ã‚­ãƒ«ãƒãƒ©ãƒ³ã‚¹ã‚’èª¿æ•´ã—ã¾ã—ãŸã€‚
        </div>
    </div>

    <div class="menu-grid">
        <a href="battle.html" class="menu-btn" style="border-color:#d4af37; background:#332200;">
            <span class="menu-icon">âš”ï¸</span>
            å‡ºé™£
        </a>
        <a href="deck.html" class="menu-btn">
            <span class="menu-icon">ğŸ¯</span>
            ç·¨æˆ
        </a>
        <a href="gacha.html" class="menu-btn">
            <span class="menu-icon">ğŸ«</span>
            ç™»ç”¨
        </a>
        <a href="shop.html" class="menu-btn">
            <span class="menu-icon">ğŸ’°</span>
            ä¸‡å±‹
        </a>
        <a href="book.html" class="menu-btn">
            <span class="menu-icon">ğŸ“œ</span>
            åé‘‘
        </a>
    </div>

    <div style="margin-top:30px; text-align:center;">
        <button onclick="document.getElementById('transfer-modal').style.display='flex'" style="background:#444; border:1px solid #666; font-size:0.8rem; padding:8px 15px;">ãƒ‡ãƒ¼ã‚¿å¼•ãç¶™ã</button>
        <button onclick="performReset()" style="background:#522; border:1px solid #844; color:#fcc; font-size:0.8rem; padding:8px 15px; margin-left:10px;">ãƒ‡ãƒ¼ã‚¿åˆæœŸåŒ–</button>
    </div>
</div>

<div id="transfer-modal" class="modal">
    <div class="modal-content">
        <h3>ãƒ‡ãƒ¼ã‚¿å¼•ãç¶™ã</h3>
        <p style="font-size:0.8rem;">æ©Ÿç¨®å¤‰æ›´ãªã©ã®éš›ã«ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚<br>ï¼ˆä¸‡å±‹ã®å®Ÿè£…ã«ã‚ˆã‚Šãƒ‡ãƒ¼ã‚¿æ§‹é€ ãŒå¤‰ã‚ã£ã¦ã„ã¾ã™ãŒã€æ—§ãƒ‡ãƒ¼ã‚¿ã‚‚èª­ã¿è¾¼ã¿å¯èƒ½ã§ã™ï¼‰</p>
        
        <div style="text-align:left; font-size:0.8rem; color:#d4af37;">ã‚ãªãŸã®ID (ã‚³ãƒ”ãƒ¼ç”¨)</div>
        <textarea id="export-area" readonly></textarea>
        <button onclick="copyCode()" style="margin-bottom:15px;">ã‚³ãƒ”ãƒ¼ã™ã‚‹</button>

        <div style="text-align:left; font-size:0.8rem; color:#d4af37; border-top:1px solid #444; padding-top:10px;">ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ (è²¼ã‚Šä»˜ã‘)</div>
        <textarea id="import-area" placeholder="ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘"></textarea>
        <button onclick="loadCode()" style="background:#d4af37; color:#000;">å¾©å…ƒã™ã‚‹</button>
        
        <button onclick="closeTransferModal()" style="margin-top:15px; background:#444;">é–‰ã˜ã‚‹</button>
    </div>
</div>

<nav class="bottom-nav">
    <a href="index.html" class="active">ãƒ›ãƒ¼ãƒ </a>
    <a href="deck.html">ç·¨æˆ</a>
    <a href="battle.html">å‡ºé™£</a>
    <a href="gacha.html">ã‚¬ãƒãƒ£</a>
</nav>

<script src="game_core.js"></script>
<script src="character_data.js"></script>
<script>
    // ãƒ‡ãƒ¼ã‚¿åˆæœŸåŒ–ãƒã‚§ãƒƒã‚¯
    if(typeof loadSaveData === 'function') {
        const data = loadSaveData();
        if(document.getElementById('export-area')) {
            document.getElementById('export-area').value = exportSaveData();
        }
    }

    function closeTransferModal() {
        document.getElementById('transfer-modal').style.display = 'none';
    }

    function copyCode() {
        const copyText = document.getElementById("export-area");
        copyText.select();
        document.execCommand("copy"); 
        if(navigator.clipboard) navigator.clipboard.writeText(copyText.value);
        alert("ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
    }

    function loadCode() {
        const code = document.getElementById("import-area").value;
        if(!code) return;
        if(confirm("ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸Šæ›¸ãã—ã¦å¾©å…ƒã—ã¾ã™ã‹ï¼Ÿ\n(ä»Šã®ãƒ‡ãƒ¼ã‚¿ã¯æ¶ˆãˆã¾ã™)")) {
            const success = importSaveData(code);
            if(success) { alert("å¾©å…ƒã«æˆåŠŸã—ã¾ã—ãŸï¼"); location.reload(); }
            else alert("ã‚³ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã‚‹ã‹ã€å£Šã‚Œã¦ã„ã¾ã™ã€‚");
        }
    }

    function performReset() {
        if(confirm("æœ¬å½“ã«ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã—ã¾ã™ã‹ï¼Ÿ\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚\n(æ‰€æŒé‡‘ã‚„æ­¦å°†ãªã©å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆã¾ã™)")) {
            if(confirm("æœ¬å½“ã«å‰Šé™¤ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ")) {
                resetSaveData();
                alert("ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã—ã¾ã—ãŸã€‚");
                location.reload();
            }
        }
    }
    
    window.onload = function() {
        if(typeof checkAndDistributeStarter === 'function') {
            const res = checkAndDistributeStarter();
            if (res.success) { alert(`ã€åˆæœŸç‰¹å…¸ã€‘ã€Œ${res.rarity}${res.name}ã€ã‚’ç²å¾—ã—ã¾ã—ãŸï¼`); }
        }
    };
</script>
</body>
</html>