<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ›ãƒ¼ãƒ  - æˆ¦å›½æ”¾ç½®RPG</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .news-box { background: #222; border: 1px solid #444; padding: 10px; margin-bottom: 20px; border-radius: 4px; }
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .menu-btn { background: #333; color: #fff; padding: 20px; text-align: center; text-decoration: none; border: 1px solid #555; border-radius: 8px; font-weight: bold; display: block; transition: background 0.2s; }
        .menu-btn:hover { background: #444; }
        .menu-icon { font-size: 2rem; display: block; margin-bottom: 5px; }
        
        /* ãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ */
        .modal { display: none; position: fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:9999; align-items:center; justify-content:center; }
        .modal-content { background:#222; border:2px solid #d4af37; padding:20px; width:90%; max-width:400px; border-radius:8px; text-align:center; color:#fff; }
        textarea { width:100%; height:100px; background:#111; color:#fff; border:1px solid #555; margin-bottom:10px; font-size:0.8rem; }
        .btn-trans { padding:10px; width:100%; margin-bottom:5px; cursor:pointer; font-weight:bold; border-radius:4px; }
        .btn-copy { background:#446; color:#fff; border:1px solid #668; }
        .btn-load { background:#d4af37; color:#000; border:none; }
    </style>
</head>
<body>

<header>
    <h1>æˆ¦å›½æ”¾ç½®RPG</h1>
</header>

<div class="container">
    
    <div class="news-box">
        <div style="color:#d4af37; font-weight:bold; margin-bottom:5px;">â—† æ›´æ–°æƒ…å ±</div>
        <ul style="font-size:0.85rem; padding-left:20px; color:#ccc;">
            <li>Ver32.0: ãƒ‡ãƒ¼ã‚¿åˆæœŸåŒ–æ©Ÿèƒ½è¿½åŠ </li>
            <li>Ver31.0: æ•µç‰¹æŠ€ãƒ»å¼•ãç¶™ãå®Ÿè£…</li>
            <li>Ver30.0: Rç¹”ç”°ä¿¡é•· é…å¸ƒç¢ºå®š</li>
        </ul>
    </div>

    <div class="menu-grid">
        <a href="battle.html" class="menu-btn">
            <span class="menu-icon">âš”ï¸</span>
            å‡ºé™£
        </a>
        <a href="deck.html" class="menu-btn">
            <span class="menu-icon">ğŸ¯</span>
            ç·¨æˆãƒ»æ­¦å°†
        </a>
        <a href="gacha.html" class="menu-btn">
            <span class="menu-icon">ğŸ´</span>
            ã‚¬ãƒãƒ£
        </a>
        <div onclick="openTransferModal()" class="menu-btn" style="cursor:pointer;">
            <span class="menu-icon">ğŸ“²</span>
            ãƒ‡ãƒ¼ã‚¿ç®¡ç†
        </div>
    </div>

    <div style="margin-top:20px; text-align:center; font-size:0.8rem; color:#666;">
        &copy; 2025 Sengoku Idle RPG
    </div>
</div>

<div id="transfer-modal" class="modal">
    <div class="modal-content">
        <h3 style="color:#d4af37; margin-top:0;">ãƒ‡ãƒ¼ã‚¿ç®¡ç†</h3>
        
        <div style="text-align:left; font-size:0.9rem; margin-bottom:5px;">â–¼ å¼•ãç¶™ãã‚³ãƒ¼ãƒ‰ç™ºè¡Œ (ã‚³ãƒ”ãƒ¼)</div>
        <textarea id="export-area" readonly onclick="this.select()"></textarea>
        <button class="btn-trans btn-copy" onclick="copyCode()">ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼</button>
        
        <hr style="border-color:#444; margin:15px 0;">
        
        <div style="text-align:left; font-size:0.9rem; margin-bottom:5px;">â–¼ ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒ (ä¸Šæ›¸ã)</div>
        <textarea id="import-area" placeholder="ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘"></textarea>
        <button class="btn-trans btn-load" onclick="loadCode()">ãƒ‡ãƒ¼ã‚¿ã‚’å¾©å…ƒã™ã‚‹</button>

        <hr style="border-color:#444; margin:15px 0;">
        
        <div style="text-align:left; font-size:0.9rem; margin-bottom:5px; color:#f55;">â–¼ ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ– (æœ€åˆã‹ã‚‰éŠã¶)</div>
        <button class="btn-trans" style="background:#522; border:1px solid #844; color:#fcc;" onclick="performReset()">ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ã¦åˆæœŸåŒ–</button>
        
        <button class="btn-trans" style="background:#333; border:1px solid #555; color:#ccc; margin-top:10px;" onclick="closeTransferModal()">é–‰ã˜ã‚‹</button>
    </div>
</div>

<script src="character_data.js"></script>
<script src="game_core.js"></script>
<script>
    function openTransferModal() {
        document.getElementById('transfer-modal').style.display = 'flex';
        const code = exportSaveData();
        document.getElementById('export-area').value = code;
    }
    
    function closeTransferModal() {
        document.getElementById('transfer-modal').style.display = 'none';
    }

    function copyCode() {
        const copyText = document.getElementById("export-area");
        copyText.select();
        document.execCommand("copy"); 
        if(navigator.clipboard) navigator.clipboard.writeText(copyText.value);
        alert("ã‚³ãƒ¼ãƒ‰ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
    }

    function loadCode() {
        const code = document.getElementById("import-area").value;
        if(!code) return;
        if(confirm("ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸Šæ›¸ãã—ã¦å¾©å…ƒã—ã¾ã™ã‹ï¼Ÿ\n(ä»Šã®ãƒ‡ãƒ¼ã‚¿ã¯æ¶ˆãˆã¾ã™)")) {
            const success = importSaveData(code);
            if(success) { alert("å¾©å…ƒã«æˆåŠŸã—ã¾ã—ãŸï¼"); location.reload(); }
            else alert("ã‚³ãƒ¼ãƒ‰ãŒé–“é•ã£ã¦ã„ã‚‹ã‹ã€å£Šã‚Œã¦ã„ã¾ã™ã€‚");
        }
    }

    // â˜…åˆæœŸåŒ–å‡¦ç†
    function performReset() {
        if(confirm("æœ¬å½“ã«ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã—ã¾ã™ã‹ï¼Ÿ\nã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚\n(æ‰€æŒé‡‘ã‚„æ­¦å°†ãªã©å…¨ã¦ã®ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆã¾ã™)")) {
            if(confirm("æœ¬å½“ã«å‰Šé™¤ã—ã¦ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ")) {
                resetSaveData();
                alert("ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ã—ã¾ã—ãŸã€‚");
                location.reload();
            }
        }
    }
    
    // åˆæœŸé…å¸ƒãƒã‚§ãƒƒã‚¯
    window.onload = function() {
        if(typeof checkAndDistributeStarter === 'function') {
            const res = checkAndDistributeStarter();
            if (res.success) {
                alert(`ã€åˆæœŸç‰¹å…¸ã€‘ã€Œ${res.rarity}${res.name}ã€ã‚’ç²å¾—ã—ã¾ã—ãŸï¼`);
                // ãƒªãƒ­ãƒ¼ãƒ‰ã—ã¦åæ˜ 
                location.reload(); 
            }
        }
    }
</script>

</body>
</html>